import{a as ee}from"./chunk-F6FITZPJ.js";import{a as P,b as Z,c as $}from"./chunk-YAUKNFNJ.js";import{D as x,E as F,Ha as q,Ja as B,Ka as G,L as p,La as H,Oa as j,Pa as V,Qa as W,Sa as z,U as L,Ua as J,Va as K,X as U,Xa as Q,Ya as X,Za as Y,ga as v,ha as T,ia as A,ja as R,ka as D,la as k,m as S,n as h,o as _,oa as N,pa as M,q as C,qa as O,t as w,v as g,w as c,x as s,y as b}from"./chunk-CY6DQVHM.js";import"./chunk-2XE4O6AU.js";import"./chunk-JVPYE6XL.js";import"./chunk-GYMOEWCA.js";import"./chunk-7KY5EJKB.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-6BZ4INXC.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as m}from"./chunk-RW4GY4BD.js";var f=function(a){return a.Prompt="PROMPT",a.Camera="CAMERA",a.Photos="PHOTOS",a}(f||{}),y=function(a){return a.Rear="REAR",a.Front="FRONT",a}(y||{}),I=function(a){return a.Uri="uri",a.Base64="base64",a.DataUrl="dataUrl",a}(I||{});var E=class extends ${getPhoto(t){return m(this,null,function*(){return new Promise((o,i)=>m(this,null,function*(){if(t.webUseInput||t.source===f.Photos)this.fileInputExperience(t,o,i);else if(t.source===f.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=t.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:t.promptLabelPhoto||"From Photos"},{title:t.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",n=>m(this,null,function*(){n.detail===0?this.fileInputExperience(t,o,i):this.cameraExperience(t,o,i)}))}else this.cameraExperience(t,o,i)}))})}pickImages(t){return m(this,null,function*(){return new Promise((o,i)=>m(this,null,function*(){this.multipleFileInputExperience(o,i)}))})}cameraExperience(t,o,i){return m(this,null,function*(){if(customElements.get("pwa-camera-modal")){let e=document.createElement("pwa-camera-modal");e.facingMode=t.direction===y.Front?"user":"environment",document.body.appendChild(e);try{yield e.componentOnReady(),e.addEventListener("onPhoto",n=>m(this,null,function*(){let r=n.detail;r===null?i(new P("User cancelled photos app")):r instanceof Error?i(r):o(yield this._getCameraPhoto(r,t)),e.dismiss(),document.body.removeChild(e)})),e.present()}catch{this.fileInputExperience(t,o,i)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(t,o,i)})}fileInputExperience(t,o,i){let e=document.querySelector("#_capacitor-camera-input"),n=()=>{var r;(r=e.parentNode)===null||r===void 0||r.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",r=>{let l=e.files[0],u="jpeg";if(l.type==="image/png"?u="png":l.type==="image/gif"&&(u="gif"),t.resultType==="dataUrl"||t.resultType==="base64"){let d=new FileReader;d.addEventListener("load",()=>{if(t.resultType==="dataUrl")o({dataUrl:d.result,format:u});else if(t.resultType==="base64"){let ie=d.result.split(",")[1];o({base64String:ie,format:u})}n()}),d.readAsDataURL(l)}else o({webPath:URL.createObjectURL(l),format:u}),n()}),e.addEventListener("cancel",r=>{i(new P("User cancelled photos app")),n()})),e.accept="image/*",e.capture=!0,t.source===f.Photos||t.source===f.Prompt?e.removeAttribute("capture"):t.direction===y.Front?e.capture="user":t.direction===y.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(t,o){let i=document.querySelector("#_capacitor-camera-input-multiple"),e=()=>{var n;(n=i.parentNode)===null||n===void 0||n.removeChild(i)};i||(i=document.createElement("input"),i.id="_capacitor-camera-input-multiple",i.type="file",i.hidden=!0,i.multiple=!0,document.body.appendChild(i),i.addEventListener("change",n=>{let r=[];for(let l=0;l<i.files.length;l++){let u=i.files[l],d="jpeg";u.type==="image/png"?d="png":u.type==="image/gif"&&(d="gif"),r.push({webPath:URL.createObjectURL(u),format:d})}t({photos:r}),e()}),i.addEventListener("cancel",n=>{o(new P("User cancelled photos app")),e()})),i.accept="image/*",i.click()}_getCameraPhoto(t,o){return new Promise((i,e)=>{let n=new FileReader,r=t.type.split("/")[1];o.resultType==="uri"?i({webPath:URL.createObjectURL(t),format:r,saved:!1}):(n.readAsDataURL(t),n.onloadend=()=>{let l=n.result;o.resultType==="dataUrl"?i({dataUrl:l,format:r,saved:!1}):i({base64String:l.split(",")[1],format:r,saved:!1})},n.onerror=l=>{e(l)})})}checkPermissions(){return m(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return m(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return m(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return m(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},se=new E;var te=Z("Camera",{web:()=>new E});function ne(a,t){a&1&&(c(0,"ion-item")(1,"ion-text",10),p(2,"El t\xEDtulo debe tener una extensi\xF3n de m\xEDnimo 5 caracteres"),s()())}function ae(a,t){a&1&&(c(0,"ion-item")(1,"ion-text",10),p(2,"La descripci\xF3n debe tener una extensi\xF3n m\xEDnima de 20 caracteres."),s()())}function re(a,t){if(a&1&&(c(0,"ion-item"),b(1,"img",11),s()),a&2){let o=F();h(),g("src",o.imagen,S)}}var xe=(()=>{let t=class t{constructor(i,e){this.fb=i,this.avisosService=e,this.imagen=null,this.form=this.fb.group({titulo:["",[v.required,v.minLength(5)]],descripcion:["",[v.required,v.minLength(20)]]})}capturarFoto(){return m(this,null,function*(){let i=yield te.getPhoto({resultType:I.DataUrl,source:f.Camera,quality:90});this.imagen=i.dataUrl||null})}guardarAviso(){let i={id:Date.now(),titulo:this.form.value.titulo,descripcion:this.form.value.descripcion,imagen:this.imagen,fecha:new Date().toISOString()};this.avisosService.agregarAviso(i).then(()=>{this.form.reset(),this.imagen=null})}};t.\u0275fac=function(e){return new(e||t)(_(N),_(ee))},t.\u0275cmp=C({type:t,selectors:[["app-formulario-avisos"]],decls:27,vars:5,consts:[["slot","start"],["defaultHref","/listado-avisos"],[3,"ngSubmit","formGroup"],["position","stacked"],["formControlName","titulo"],[4,"ngIf"],["formControlName","descripcion"],["expand","block",3,"click"],["slot","start","name","camera"],["expand","block","type","submit",3,"disabled"],["color","danger"],["alt","Imagen Capturada",2,"max-width","100%","height","auto",3,"src"]],template:function(e,n){if(e&1&&(c(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),b(3,"ion-back-button",1),s(),c(4,"ion-title"),p(5,"Publicaci\xF3n"),s()()(),c(6,"ion-content")(7,"form",2),x("ngSubmit",function(){return n.guardarAviso()}),c(8,"ion-item")(9,"ion-label",3),p(10,"T\xEDtulo"),s(),b(11,"ion-input",4),s(),w(12,ne,3,0,"ion-item",5),c(13,"ion-item")(14,"ion-label",3),p(15,"Descripci\xF3n"),s(),b(16,"ion-textarea",6),s(),w(17,ae,3,0,"ion-item",5),c(18,"ion-item")(19,"ion-label",3),p(20,"Fotograf\xEDa"),s(),c(21,"ion-button",7),x("click",function(){return n.capturarFoto()}),b(22,"ion-icon",8),p(23," Capturar Foto "),s()(),w(24,re,2,1,"ion-item",5),c(25,"ion-button",9),p(26," GUARDAR "),s()()()),e&2){let r,l;h(7),g("formGroup",n.form),h(5),g("ngIf",((r=n.form.get("titulo"))==null?null:r.invalid)&&((r=n.form.get("titulo"))==null?null:r.touched)),h(5),g("ngIf",((l=n.form.get("descripcion"))==null?null:l.invalid)&&((l=n.form.get("descripcion"))==null?null:l.touched)),h(7),g("ngIf",n.imagen),h(),g("disabled",n.form.invalid)}},dependencies:[G,j,K,J,H,V,W,X,B,Y,q,z,Q,M,R,T,A,U,L,O,D,k],encapsulation:2});let a=t;return a})();export{xe as FormularioAvisosPage};
